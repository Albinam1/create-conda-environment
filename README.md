# create-conda-environment
Создаем  conda-окружение на windows (ну почти)


Если на компьютере стоит Windows: нужно установить WSL (https://docs.microsoft.com/ru-ru/windows/wsl/install-win10), а после него нужный дистрибутив Linux и Терминал Windows (оба из Microsoft Store, описание там же в статье). Дистрибутив на ваше усмотрение;
(p.s. у меня стоит ubuntu)
Можете скачать через командную строку (нажимаете shift + Win + R, вбиваете cmd, нажимаете Enter)
А можете через MicrosoftStore. Скачиваете приложение ubuntu
( Если на компьютере стоит macOS: желательно установить iTerm2 (https://www.iterm2.com/), хотя можно обойтись и оригинальным Терминалом (Terminal; находится в папке Программы/Утилиты (/Applications/Utilities)).
Если Linux: выберите приложение для работы с консолью на ваш вкус.
Не надо устанавливать Linux только ради его наличия. Это лишний риск и потеря времени. WSL или макоси будет более чем достаточно.) 


Настраиваем miniconda и bioconda

Miniconda- это бесплатный минимальный установщик для conda. Это небольшая загрузочная версия Anaconda, включающая только conda, Python, пакеты, от которых они оба зависят, и небольшое количество других полезных пакетов (например, pip, zlib и некоторые другие). Я скачала его, так как он легче.

Bioconda - программа, которая позволяет устанавливать тысячи пакетов программного обеспечения, связанных с биомедицинскими исследованиями, включая анализ ngs. 
С её помощью вы сможете устанавливать научные программы на свой компьютер и проводить нетяжёлые расчёты у себя. 

Здесь и далее везде на компьютере с Windows: надо сначала зайти в подсистему Linux (у меня Ubuntu) и всё делать в ней.
Установим miniconda3  (будем скачивать через сайт https://docs.conda.io/projects/miniconda/en/latest/) и настроим наше окружение на канал bioconda с помощью следующих команд:
Скачиваем miniconda через Ubuntu скачиваем для Linux, так как работаем через дистрибутив Linux:

wget https://docs.conda.io/projects/miniconda/en/latest/#:~:text=Miniconda3%20Linux%2064%2Dbit

Далее видим файл Miniconda3-latest-Linux-x86_64.sh

Вводим в терминал (я так буду называть мой Ubuntu) следующую комманду:
bash Miniconda3-latest-Linux-x86_64.sh


Видим приветсвенное слово, жмем Enter до того как нам не предложет нажать yes/no

При установке мы соглашаемся со всем, так что жмем yes

Установка должна пройти успешно. После чего мы выходим из терминала (нажимаем на крестик) и заходим обратно в него

Пишем в терминал комманду conda --version
В результате вы увидите версию Conda, установленную на вашем ПК. А это значит, что у нас все готово для работы.

Настроиваем наше окружение на канал bioconda:

conda config --add channels defaults
conda config --add channels bioconda
conda config --add channels conda-forge
conda config --set channel_priority strict

1. Проверка доступных сред 
Для начала выясним, какие среды находятся в нашем распоряжении. Выполняем следующую команду: 

conda env list
Предположим, вы только что установили Conda, тогда непременно увидите вот такой результат: 

# среды conda 
# 
base * /opt/anaconda3
base —  среда по умолчанию, созданная Conda в процессе установки. 
Символ * указывает на то, что эта конкретная среда является активной. 
Путь показывает физическую директорию среды и связанные с ней пакеты. 
Вышеуказанная команда проверки применяется для обзора сред Conda, доступных на ПК.  

2. Создание новой среды 
Для создания новой среды существует следующая команда:

conda create --name NGS
Флаг --name говорит о намерении указать имя новой среды. В данном случае она будет называться NGS
Вместо --name возможен краткий вариант -n.
Эту команду можно расширить, чтобы установить дополнительные пакеты в процессе создания среды, к примеру NumPy и Requests: 

conda create -name firstenv numpy requests
Более того, у нас даже есть возможность указать конкретные версии этих пакетов, как показано ниже: 

conda create -n firstenv numpy=1.19.2 requests=2.23.0

После установки можно удостовериться в успешном создании среды с помощью команды conda env list, отображающей NGS в списке. 

Если вы в курсе, какие пакеты необходимы для среды, то в процессе ее создания можно установить сразу их все. Это позволит избежать конфликтов зависимостей, к которым могут привести отдельные установки.  

3. Активация среды 
Как только вы создали среду, самое время в нее войти. На профессиональном языке этот процесс называется “активацией”. Выполняем код: 

conda activate NGS
После выполнения вы заметите, что в начале строки появилось название среды (NGS) или (your-own-env-name) в случае выбора другого имени, как показано ниже: 

Поскольку среда NGS уже активирована, попробуйте ради интереса снова выполнить conda env list. Вы увидите, что в строке firstenv появится символ *. 

4. Установка, обновление и удаление пакетов
В уже существующей среде вы можете установить дополнительные пакеты, которые забыли указать при ее создании. Для этого существуют несколько способов в зависимости от доступности пакетов. 

Сначала попробуем выполнить команду, устанавливающую пакет из предустановленного канала Anaconda. Отметим, что при желании вслед за именем пакета можно указать его версию. 

conda install fastqc (или коммманда conda install::bioconda fastqc)

Для удаления пакета воспользуйтесь командой uninstall, как показано ниже. Отметим, что иначе она называется remove, например conda remove pandas.

conda uninstall pandas
5. Проверка установленных пакетов 
По ходу работы в среде число пакетов возрастает, и в какой-то момент возникает необходимость проверить, какие из них уже установлены. Для этого выполняем следующую команду: 

conda list
В результате вы увидите подобное: 

# пакеты в среде в /opt/anaconda3/envs/firstenv:
#
# Имя                     Версия           Сборка  Канал
appnope                   0.1.2                    pypi_0    pypi
backcall                  0.2.0                    pypi_0    pypi
blas                      1.0                         mkl  
brotlipy                  0.7.0           py38h9ed2024_1003  
bzip2                     1.0.8                hc929b4f_4    conda-forge
c-ares                    1.17.1               hc929b4f_0    conda-forge
ca-certificates           2020.12.5            h033912b_0    conda-forge
cairo                     1.16.0            h4ec454a_1007    conda-forge
certifi                   2020.12.5        py38h50d1736_1    conda-forge
cffi                      1.14.5           py38h2125817_0  
chardet                   4.0.0           py38hecd8cb5_1003  
cryptography              3.3.1            py38hbcfaee0_1  
...
Обратите внимание, что список указывает, из какого канала устанавливаются пакеты. В данном случае в нашем распоряжении пакеты из PyPI и conda-forge. Отсутствие информации о канале означает, что по умолчанию пакеты устанавливаются из Anaconda. 

Если чрезмерная длина списка усложняет поиск конкретного пакета, можно проверить информацию только по одному, выполнив команду: 

conda list opencv
6. Деактивация среды 
Закончив работу, вы покидаете текущую среду или, опираясь на терминологию, деактивируете ее. Для этой цели существует команда: 

conda deactivate
Вы заметите отсутствие префикса (NGS) в сообщении командной строки. Ради интереса можете выполнить conda env list, чтобы убедиться, что среда NGS больше не обозначена символом *, указывающим на ее активность.  






